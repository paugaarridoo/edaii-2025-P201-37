3844
Apollonian gasket
In mathematics, an Apollonian gasket or Apollonian net is a fractal generated by starting with a triple of circles, each tangent to the other two, and successively filling in more circles, each tangent to another three. It is named after Greek mathematician [Apollonius of Perga](3846).

Construction
The construction of the Apollonian gasket starts with three circles 
  
    
      
        
          C
          
            1
          
        
      
    
    {\displaystyle C_{1}}
  
, 
  
    
      
        
          C
          
            2
          
        
      
    
    {\displaystyle C_{2}}
  
, and 
  
    
      
        
          C
          
            3
          
        
      
    
    {\displaystyle C_{3}}
  
 (black in the figure), that are each tangent to the other two, but that do not have a single point of triple tangency. These circles may be of different sizes to each other, and it is allowed for two to be inside the third, or for all three to be outside each other. As Apollonius discovered, there exist two more circles 
  
    
      
        
          C
          
            4
          
        
      
    
    {\displaystyle C_{4}}
  
 and 
  
    
      
        
          C
          
            5
          
        
      
    
    {\displaystyle C_{5}}
  
 (red) that are tangent to all three of the original circles – these are called [Apollonian circles](3843). These five circles are separated from each other by six curved triangular regions, each bounded by the arcs from three pairwise-tangent circles. The construction continues by adding six more circles, one in each of these six curved triangles, tangent to its three sides. These in turn create 18 more curved triangles, and the construction continues by again filling these with tangent circles, ad infinitum.
Continued stage by stage in this way, the construction adds 
  
    
      
        2
        ⋅
        
          3
          
            n
          
        
      
    
    {\displaystyle 2\cdot 3^{n}}
  
 new circles at stage 
  
    
      
        n
      
    
    {\displaystyle n}
  
, giving a total of 
  
    
      
        
          3
          
            n
            +
            1
          
        
        +
        2
      
    
    {\displaystyle 3^{n+1}+2}
  
 circles after 
  
    
      
        n
      
    
    {\displaystyle n}
  
 stages. In the limit, this set of circles is an Apollonian gasket. In it, each pair of tangent circles has an infinite Pappus chain of circles tangent to both circles in the pair.

The size of each new circle is determined by Descartes' theorem, which states that, for any four mutually tangent circles, the radii 
  
    
      
        
          r
          
            i
          
        
      
    
    {\displaystyle r_{i}}
  
 of the circles obeys the equation

  
    
      
        
          
            (
            
              
                
                  1
                  
                    r
                    
                      1
                    
                  
                
              
              +
              
                
                  1
                  
                    r
                    
                      2
                    
                  
                
              
              +
              
                
                  1
                  
                    r
                    
                      3
                    
                  
                
              
              +
              
                
                  1
                  
                    r
                    
                      4
                    
                  
                
              
            
            )
          
          
            2
          
        
        =
        2
        
          (
          
            
              
                1
                
                  r
                  
                    1
                  
                  
                    2
                  
                
              
            
            +
            
              
                1
                
                  r
                  
                    2
                  
                  
                    2
                  
                
              
            
            +
            
              
                1
                
                  r
                  
                    3
                  
                  
                    2
                  
                
              
            
            +
            
              
                1
                
                  r
                  
                    4
                  
                  
                    2
                  
                
              
            
          
          )
        
        .
      
    
    {\displaystyle \left({\frac {1}{r_{1}}}+{\frac {1}{r_{2}}}+{\frac {1}{r_{3}}}+{\frac {1}{r_{4}}}\right)^{2}=2\left({\frac {1}{r_{1}^{2}}}+{\frac {1}{r_{2}^{2}}}+{\frac {1}{r_{3}^{2}}}+{\frac {1}{r_{4}^{2}}}\right).}
  

This equation may have a solution with a negative radius; this means that one of the circles (the one with negative radius) surrounds the other three.
One or two of the initial circles of this construction, or the circles resulting from this construction, can degenerate to a straight line, which can be thought of as a circle with infinite radius. When there are two lines, they must be parallel, and are considered to be tangent at a point at infinity. When the gasket includes two lines on the 
  
    
      
        x
      
    
    {\displaystyle x}
  
-axis and one unit above it, and a circle of unit diameter tangent to both lines centered on the 
  
    
      
        y
      
    
    {\displaystyle y}
  
-axis, then the circles that are tangent to the 
  
    
      
        x
      
    
    {\displaystyle x}
  
-axis are the Ford circles, important in number theory.
The Apollonian gasket has a Hausdorff dimension of about 1.3057. Because it has a well-defined fractional dimension, even though it is not precisely self-similar, it can be thought of as a fractal.

Symmetries
The Möbius transformations of the plane preserve the shapes and tangencies of circles, and therefore preserve the structure of an Apollonian gasket.
Any two triples of mutually tangent circles in an Apollonian gasket may be mapped into each other by a Möbius transformation, and any two Apollonian gaskets may be mapped into each other by a Möbius transformation. In particular, for any two tangent circles in any Apollonian gasket, an inversion in a circle centered at the point of tangency (a special case of a Möbius transformation) will transform these two circles into two parallel lines, and transform the rest of the gasket into the special form of a gasket between two parallel lines. Compositions of these inversions can be used to transform any two points of tangency into each other. Möbius transformations are also isometries of the hyperbolic plane, so in hyperbolic geometry all Apollonian gaskets are congruent. In a sense, there is therefore only one Apollonian gasket, up to (hyperbolic) isometry.
The Apollonian gasket is the limit set of a group of Möbius transformations known as a Kleinian group.
For Euclidean symmetry transformations rather than Möbius transformations, in general, the Apollonian gasket will inherit the symmetries of its generating set of three circles. However, some triples of circles can generate Apollonian gaskets with higher symmetry than the initial triple; this happens when the same gasket has a different and more-symmetric set of generating circles. Particularly symmetric cases include the Apollonian gasket between two parallel lines (with infinite dihedral symmetry), the Apollonian gasket generated by three congruent circles in an equilateral triangle (with the symmetry of the triangle), and the Apollonian gasket generated by two circles of radius 1 surrounded by a circle of radius 2 (with two lines of reflective symmetry).

Integral Apollonian circle packings
If any four mutually tangent circles in an Apollonian gasket all have integer curvature (the inverse of their radius) then all circles in the gasket will have integer curvature.
Since the equation relating curvatures in an Apollonian gasket, integral or not, is

  
    
      
        
          a
          
            2
          
        
        +
        
          b
          
            2
          
        
        +
        
          c
          
            2
          
        
        +
        
          d
          
            2
          
        
        =
        2
        a
        b
        +
        2
        a
        c
        +
        2
        a
        d
        +
        2
        b
        c
        +
        2
        b
        d
        +
        2
        c
        d
        ,
        
      
    
    {\displaystyle a^{2}+b^{2}+c^{2}+d^{2}=2ab+2ac+2ad+2bc+2bd+2cd,\,}
  

it follows that one may move from one quadruple of curvatures to another by Vieta jumping, just as when finding a new   Markov number.
The first few of these integral Apollonian gaskets are listed in the following table. The table lists the curvatures of the largest circles in the gasket. Only the first three curvatures (of the five displayed in the table) are needed to completely describe each gasket – all other curvatures can be derived from these three.

Enumerating integral Apollonian circle packings
The curvatures 
  
    
      
        (
        a
        ,
        b
        ,
        c
        ,
        d
        )
      
    
    {\displaystyle (a,b,c,d)}
  
 are a root quadruple (the smallest in some integral circle packing) if 
  
    
      
        a
        <
        0
        ≤
        b
        ≤
        c
        ≤
        d
      
    
    {\displaystyle a<0\leq b\leq c\leq d}
  
. They are primitive when 
  
    
      
        gcd
        (
        a
        ,
        b
        ,
        c
        ,
        d
        )
        =
        1
      
    
    {\displaystyle \gcd(a,b,c,d)=1}
  
. Defining a new set of variables 
  
    
      
        (
        x
        ,
        
          d
          
            1
          
        
        ,
        
          d
          
            2
          
        
        ,
        m
        )
      
    
    {\displaystyle (x,d_{1},d_{2},m)}
  
 by the matrix equation

  
    
      
        
          
            
            
              
                
                  a
                
              
              
                
                  b
                
              
              
                
                  c
                
              
              
                
                  d
                
              
            
            
          
        
        =
        
          
            
            
              
                
                  1
                
                
                  0
                
                
                  0
                
                
                  0
                
              
              
                
                  −
                  1
                
                
                  1
                
                
                  0
                
                
                  0
                
              
              
                
                  −
                  1
                
                
                  0
                
                
                  1
                
                
                  0
                
              
              
                
                  −
                  1
                
                
                  1
                
                
                  1
                
                
                  −
                  2
                
              
            
            
          
        
        
          
            
            
              
                
                  x
                
              
              
                
                  
                    d
                    
                      1
                    
                  
                
              
              
                
                  
                    d
                    
                      2
                    
                  
                
              
              
                
                  m
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{bmatrix}a\\b\\c\\d\end{bmatrix}}={\begin{bmatrix}1&0&0&0\\-1&1&0&0\\-1&0&1&0\\-1&1&1&-2\end{bmatrix}}{\begin{bmatrix}x\\d_{1}\\d_{2}\\m\end{bmatrix}}}
  

gives a system where 
  
    
      
        (
        a
        ,
        b
        ,
        c
        ,
        d
        )
      
    
    {\displaystyle (a,b,c,d)}
  
 satisfies the Descartes equation precisely when 
  
    
      
        
          x
          
            2
          
        
        +
        
          m
          
            2
          
        
        =
        
          d
          
            1
          
        
        
          d
          
            2
          
        
      
    
    {\displaystyle x^{2}+m^{2}=d_{1}d_{2}}
  
. Furthermore, 
  
    
      
        (
        a
        ,
        b
        ,
        c
        ,
        d
        )
      
    
    {\displaystyle (a,b,c,d)}
  
 is primitive precisely when 
  
    
      
        gcd
        (
        x
        ,
        
          d
          
            1
          
        
        ,
        
          d
          
            2
          
        
        )
        =
        1
      
    
    {\displaystyle \gcd(x,d_{1},d_{2})=1}
  
, and 
  
    
      
        (
        a
        ,
        b
        ,
        c
        ,
        d
        )
      
    
    {\displaystyle (a,b,c,d)}
  
 is a root quadruple precisely when 
  
    
      
        x
        <
        0
        ≤
        2
        m
        ≤
        
          d
          
            1
          
        
        ≤
        
          d
          
            2
          
        
      
    
    {\displaystyle x<0\leq 2m\leq d_{1}\leq d_{2}}
  
.
This relationship can be used to find all the primitive root quadruples with a given negative bend 
  
    
      
        x
      
    
    {\displaystyle x}
  
. It follows from 
  
    
      
        2
        m
        ≤
        
          d
          
            1
          
        
      
    
    {\displaystyle 2m\leq d_{1}}
  
 and 
  
    
      
        2
        m
        ≤
        
          d
          
            2
          
        
      
    
    {\displaystyle 2m\leq d_{2}}
  
 that 
  
    
      
        4
        
          m
          
            2
          
        
        ≤
        
          d
          
            1
          
        
        
          d
          
            2
          
        
      
    
    {\displaystyle 4m^{2}\leq d_{1}d_{2}}
  
, and hence that 
  
    
      
        3
        
          m
          
            2
          
        
        ≤
        
          d
          
            1
          
        
        
          d
          
            2
          
        
        −
        
          m
          
            2
          
        
        =
        
          x
          
            2
          
        
      
    
    {\displaystyle 3m^{2}\leq d_{1}d_{2}-m^{2}=x^{2}}
  
. Therefore, any root quadruple will satisfy 
  
    
      
        0
        ≤
        m
        ≤
        
          |
        
        x
        
          |
        
        
          /
        
        
          
            3
          
        
      
    
    {\displaystyle 0\leq m\leq |x|/{\sqrt {3}}}
  
. By iterating over all the possible values of 
  
    
      
        m
      
    
    {\displaystyle m}
  
, 
  
    
      
        
          d
          
            1
          
        
      
    
    {\displaystyle d_{1}}
  
, and 
  
    
      
        
          d
          
            2
          
        
      
    
    {\displaystyle d_{2}}
  
 one can find all the primitive root quadruples. The following Python code demonstrates this algorithm, producing the primitive root quadruples listed above.

The curvatures appearing in a primitive integral Apollonian circle packing must belong to a set of six or eight possible residues classes modulo 24, and numerical evidence supported that any sufficiently large integer from these residue classes would also be present as a curvature within the packing. This conjecture, known as the local-global conjecture, was proved to be false in 2023.

Symmetry of integral Apollonian circle packings
There are multiple types of dihedral symmetry that can occur with a gasket depending on the curvature of the circles.

No symmetry
If none of the curvatures are repeated within the first five, the gasket contains no symmetry, which is represented by symmetry group C1; the gasket described by curvatures (−10, 18, 23, 27) is an example.

D1 symmetry
Whenever two of the largest five circles in the gasket have the same curvature, that gasket will have D1 symmetry, which corresponds to a reflection along a diameter of the bounding circle, with no rotational symmetry.

D2 symmetry
If two different curvatures are repeated within the first five, the gasket will have D2 symmetry; such a symmetry consists of two reflections (perpendicular to each other) along diameters of the bounding circle, with a two-fold rotational symmetry of 180°. The gasket described by curvatures (−1, 2, 2, 3) is the only Apollonian gasket (up to a scaling factor) to possess D2 symmetry.

D3 symmetry
There are no integer gaskets with D3 symmetry.
If the three circles with smallest positive curvature have the same curvature, the gasket will have D3 symmetry, which corresponds to three reflections along diameters of the bounding circle (spaced 120° apart), along with three-fold rotational symmetry of 120°. In this case the ratio of the curvature of the bounding circle to the three inner circles is 2√3 − 3. As this ratio is not rational, no integral Apollonian circle packings possess this D3 symmetry, although many packings come close.

Almost-D3 symmetry
The figure at left is an integral Apollonian gasket that appears to have D3 symmetry. The same figure is displayed at right, with labels indicating the curvatures of the interior circles, illustrating that the gasket actually possesses only the D1 symmetry common to many other integral Apollonian gaskets.
The following table lists more of these almost-D3 integral Apollonian gaskets. The sequence has some interesting properties, and the table lists a factorization of the curvatures, along with the multiplier needed to go from the previous set to the current one. The absolute values of the curvatures of the "a" disks obey the recurrence relation a(n) = 4a(n − 1) − a(n − 2) (sequence A001353 in the OEIS), from which it follows that the multiplier converges to √3 + 2 ≈ 3.732050807.

Sequential curvatures
For any integer n > 0, there exists an Apollonian gasket defined by the following curvatures: (−n, n + 1, n(n + 1), n(n + 1) + 1).  For example, the gaskets defined by (−2, 3, 6, 7), (−3, 4, 12, 13), (−8, 9, 72, 73), and (−9, 10, 90, 91) all follow this pattern.  Because every interior circle that is defined by n + 1 can become the bounding circle (defined by −n) in another gasket, these gaskets can be nested.  This is demonstrated in the figure at right, which contains these sequential gaskets with n running from 2 through 20.

History
Although the Apollonian gasket is named for [Apollonius of Perga](3846) -- because of its construction's dependence on the solution to the problem of Apollonius -- the earliest description of the gasket is from 1706 by Leibniz in a letter to Des Bosses.
The first modern definition of the Apollonian gasket is given by Kasner and Supnick.

See also
Apollonian network, a graph derived from finite subsets of the Apollonian gasket
Apollonian sphere packing, a three-dimensional generalization of the Apollonian gasket
Sierpiński triangle, a self-similar fractal with a similar combinatorial structure

Notes
References
Benoit B. Mandelbrot: The Fractal Geometry of Nature, W H Freeman, 1982, ISBN 0-7167-1186-9
Paul D. Bourke: "An Introduction to the Apollony Fractal". Computers and Graphics, Vol 30, Issue 1, January 2006, pages 134–136.
Kasner, Edward; Supnick, Fred (1943). "The Apollonian packing of circles". Proceedings of the National Academy of Sciences. 29: 378–384.
A.A. Kirillov: A Tale of Two Fractals, Birkhauser, 2013.
David Mumford, Caroline Series, David Wright: Indra's Pearls: The Vision of Felix Klein, Cambridge University Press, 2002, ISBN 0-521-35253-3
Jeffrey C. Lagarias, Colin L. Mallows, Allan R. Wilks: Beyond the Descartes Circle Theorem, The American Mathematical Monthly, Vol. 109, No. 4 (Apr., 2002), pp. 338–361, (arXiv:math.MG/0101066 v1 9 Jan 2001)

External links

Weisstein, Eric W. "Apollonian Gasket". MathWorld.
Alexander Bogomolny, Apollonian Gasket, cut-the-knot
An interactive Apollonian gasket running on pure HTML5 at the Wayback Machine (archived 2011-05-02)
A Matlab script to plot 2D Apollonian gasket with n identical circles Archived 2008-10-07 at the Wayback Machine using circle inversion
Online experiments with JSXGraph
Apollonian Gasket by Michael Screiber, The Wolfram Demonstrations Project.
Interactive Apollonian Gasket Demonstration of an Apollonian gasket running on Java
Dana Mackenzie. Computing Science: A Tisket, a Tasket, an Apollonian Gasket. American Scientist, January/February 2010.
"Sand drawing the world's largest single artwork", The Telegraph, 16 Dec 2009. Newspaper story about an artwork in the form of a partial Apollonian gasket, with an outer circumference of nine miles.
Dynamic apollonian gaskets, Tartapelago by Giorgio Pietrocola, 2014. (in Italian)